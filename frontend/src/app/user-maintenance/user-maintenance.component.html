<div class="user-maintenance">
    <h2>User Maintenance</h2>

    <!-- Form container -->
    <div class="form-container">
        <!-- Row 1: Basic user details -->
        <div class="row-1">
            <div class="section user" data-title="User Details">
                <div>
                    <label>User Name</label>
                    <input type="text" [(ngModel)]="selectedUser.UserName" />
                    <!-- Inline error if hasSubmitted && empty -->
                    <div *ngIf="hasSubmitted && !selectedUser.UserName?.trim()" class="inline-error">
                        User Name is required.
                    </div>
                </div>

                <div>
                    <label>Email</label>
                    <input type="text" [(ngModel)]="selectedUser.UserEmail" />
                    <div *ngIf="hasSubmitted && !selectedUser.UserEmail?.trim()" class="inline-error">
                        Email is required.
                    </div>
                </div>

                <div>
                    <label>Role</label>
                    <select [(ngModel)]="selectedUser.UserRole">
                        <option value="">-- Select Role --</option>
                        <option *ngFor="let r of userRoles" [value]="r">{{ r }}</option>
                    </select>
                    <div *ngIf="hasSubmitted && !selectedUser.UserRole?.trim()" class="inline-error">
                        Role is required.
                    </div>
                </div>

                <div>
                    <label>Password</label>
                    <input type="password" [(ngModel)]="selectedUser.UserPassword" />
                    <!-- Only required if adding new user (i.e. no UserID) -->
                    <div *ngIf="hasSubmitted && !selectedUser.UserID && !selectedUser.UserPassword?.trim()"
                        class="inline-error">
                        Password is required for new users.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Buttons -->
    <div class="buttons">
        <button (click)="addUser()">Add</button>
        <button (click)="modifyUser()">Modify</button>
        <button (click)="deleteUser()">Delete</button>
        <button (click)="cancel()">Cancel</button>
    </div>

    <!-- Results Area: Grid-based drag-and-drop columns -->
    <div class="results-area">
        <div class="grid-table" cdkDropList cdkDropListOrientation="horizontal" [cdkDropListData]="columns"
            (cdkDropListDropped)="onDrop($event)" [style.gridTemplateColumns]="gridTemplateColumns">
            <div class="grid-column" *ngFor="let column of columns; trackBy: trackByColumn" cdkDrag
                [cdkDragData]="column" (cdkDragEntered)="onDragEntered($event)" (cdkDragExited)="onDragExited($event)">
                <!-- Column Header -->
                <div class="grid-column-header">
                    <span class="drag-handle" cdkDragHandle>â˜°</span>
                    {{ column.header }}
                </div>

                <!-- Column cells -->
                <div class="grid-column-cell" *ngFor="let row of users; trackBy: trackByUserID"
                    (click)="selectUser(row)">
                    {{ getCellValue(row, column) }}
                </div>
            </div>
        </div>
    </div>
</div>