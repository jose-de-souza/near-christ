<div class="parish-maintenance">
    <h2>Parish Maintenance</h2>

    <!-- Form container -->
    <div class="form-container">
        <!-- Section #1: Parish Details -->
        <div class="section parish" data-title="Parish Details">
            <div class="row-1">
                <!-- Parish Name -->
                <div class="field-group parishName">
                    <label>Parish Name</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishName" />
                    <div *ngIf="hasSubmitted && !selectedParish.ParishName?.trim()" class="inline-error">
                        Parish Name is required.
                    </div>
                </div>
                <!-- Street No -->
                <div class="field-group streetNo">
                    <label>Street No</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishStNumber" />
                </div>
                <!-- Street Name -->
                <div class="field-group streetName">
                    <label>Street Name</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishStName" />
                </div>
                <!-- Suburb -->
                <div class="field-group suburb">
                    <label>Suburb</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishSuburb" />
                </div>
            </div>
        </div>

        <!-- Section #2: Location / Contact -->
        <div class="section location" data-title="Location / Contact">
            <div class="row-2">
                <!-- State dropdown -->
                <div class="field-group state">
                    <label>State</label>
                    <select [(ngModel)]="selectedParish.StateID">
                        <option [value]="0">Select State</option>
                        <option *ngFor="let st of allStates" [value]="st.StateID">
                            {{ st.StateAbbreviation }}
                        </option>
                    </select>
                </div>
                <div class="field-group postcode">
                    <label>Postcode</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishPostcode" />
                </div>
                <div class="field-group phone">
                    <label>Phone</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishPhone" />
                </div>
                <div class="field-group email">
                    <label>Email</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishEmail" />
                </div>
                <div class="field-group website">
                    <label>Website</label>
                    <input type="text" [(ngModel)]="selectedParish.ParishWebsite" />
                </div>
            </div>
        </div>

        <!-- Section #3: Filter (State and Diocese) -->
        <div class="section filter" data-title="Filter">
            <div class="row-filter">
                <!-- State Filter -->
                <div class="field-group state">
                    <label>State</label>
                    <select [(ngModel)]="filterStateID" (change)="onFilterStateChange()">
                        <option [value]="0">All States</option>
                        <option *ngFor="let st of allStates" [value]="st.StateID">
                            {{ st.StateAbbreviation }}
                        </option>
                    </select>
                </div>
                <!-- Diocese Filter -->
                <div class="field-group diocese">
                    <label>Diocese</label>
                    <select [(ngModel)]="filterDioceseID" (change)="onFilterDioceseChange()"
                        [disabled]="dioceseFilterDisabled">
                        <option [value]="0">All Dioceses</option>
                        <option *ngFor="let d of filteredDiocesesForFilter" [ngValue]="d.DioceseID">
                            {{ d.DioceseName }}
                        </option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- Buttons -->
    <div class="buttons">
        <button (click)="addParish()">Add</button>
        <button (click)="modifyParish()">Modify</button>
        <button (click)="deleteParish()">Delete</button>
        <button (click)="cancel()">Cancel</button>
    </div>

    <!-- Results area -->
    <div class="results-area">
        <div class="grid-table" cdkDropList cdkDropListOrientation="horizontal" [cdkDropListData]="columns"
            (cdkDropListDropped)="onDrop($event)" [style.gridTemplateColumns]="gridTemplateColumns">

            <div class="grid-column" *ngFor="let column of columns; trackBy: trackByParishColumn" cdkDrag
                [cdkDragData]="column" (cdkDragEntered)="onDragEntered($event)" (cdkDragExited)="onDragExited($event)">

                <div class="grid-column-header">
                    <span class="drag-handle" cdkDragHandle>â˜°</span>
                    <ng-template cdkDragPreview>
                        <div class="custom-drag-preview">{{ column.header }}</div>
                    </ng-template>
                    <ng-template cdkDragPlaceholder>
                        <div class="custom-drag-placeholder">
                            Dropping {{ column.header }} here
                        </div>
                    </ng-template>
                    {{ column.header }}
                </div>

                <div class="grid-column-cell" *ngFor="let row of parishes; trackBy: trackByParishID"
                    (click)="selectParish(row)">
                    {{ getCellValue(row, column) }}
                </div>
            </div>
        </div>
    </div>
</div>