<div class="adoration-schedule">
  <h2>Adoration Schedule</h2>

  <!-- Form Container -->
  <div class="form-container">
    <!-- Row 1: Adoration -->
    <div class="row-1">
      <!-- Single-row Adoration section -->
      <div class="section adoration" data-title="Adoration">
        <!-- 4 fields => each 24% => total 96% -->
        <div>
          <label>Adoration Type</label>
          <!-- (change)="onAdorationTypeChange()" triggers clearing fields if Perpetual -->
          <select [(ngModel)]="selectedAdoration.AdorationType" (change)="onAdorationTypeChange()">
            <option value="Perpetual">Perpetual</option>
            <option value="Regular">Regular</option>
          </select>
        </div>
        <div>
          <label>Day</label>
          <!-- Disabled if AdorationType is Perpetual -->
          <select [(ngModel)]="selectedAdoration.AdorationDay" [disabled]="isPerpetual()">
            <option value="Sunday">Sunday</option>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
          </select>
        </div>
        <div>
          <label>Start Time</label>
          <input type="time" [(ngModel)]="selectedAdoration.AdorationStart" [disabled]="isPerpetual()" />
        </div>
        <div>
          <label>End Time</label>
          <input type="time" [(ngModel)]="selectedAdoration.AdorationEnd" [disabled]="isPerpetual()" />
        </div>
      </div>
    </div><!-- end row-1 -->

    <!-- Row 2: Diocese/Parish -->
    <div class="row-2">
      <!-- Single-row Diocese/Parish section -->
      <div class="section diocese-parish-names" data-title="Diocese/Parish">
        <!-- 3 fields => State(12%), Diocese(42%), Parish(42%) => total 96% -->
        <div>
          <label>State</label>
          <select [(ngModel)]="selectedAdoration.State">
            <option value="">Select State</option>
            <option *ngFor="let s of states" [value]="s">{{ s }}</option>
          </select>
        </div>
        <div>
          <label>Diocese Name</label>
          <select [(ngModel)]="selectedAdoration.DioceseID">
            <option [value]="null">-- select diocese --</option>
            <option *ngFor="let d of dioceseList" [value]="d.DioceseID">
              {{ d.DioceseName }}
            </option>
          </select>
        </div>
        <div>
          <label>Parish Name</label>
          <!-- (change)="updateLocationFromParish()" => if user picks new parish while 'Parish Church' is selected, set location -->
          <select [(ngModel)]="selectedAdoration.ParishID" (change)="updateLocationFromParish()">
            <option [value]="null">-- select parish --</option>
            <option *ngFor="let p of parishList" [value]="p.ParishID">
              {{ p.ParishName }}
            </option>
          </select>
        </div>
      </div>
    </div><!-- end row-2 -->

    <!-- Row 3: Location -->
    <div class="row-3">
      <!-- Single-row Location section -->
      <div class="section location" data-title="Location">
        <!-- 2 fields => Location Type(20%), Location(78%) => total 98% -->
        <div>
          <label>Location Type</label>
          <!-- (change)="updateLocationFromParish()" => if user picks 'Parish Church', set location from parish -->
          <select [(ngModel)]="selectedAdoration.AdorationLocationType" (change)="updateLocationFromParish()">
            <option value="Parish Church">Parish Church</option>
            <option value="Other">Other</option>
          </select>
        </div>
        <div>
          <label>Location</label>
          <!-- disabled if isParishChurch() => 'Parish Church' -->
          <input type="text" [(ngModel)]="selectedAdoration.AdorationLocation" [disabled]="isParishChurch()" />
        </div>
      </div>
    </div><!-- end row-3 -->
  </div><!-- end form-container -->

  <!-- Action Buttons -->
  <div class="buttons">
    <button (click)="addSchedule()">Add</button>
    <button (click)="modifySchedule()">Modify</button>
    <button (click)="deleteSchedule()">Delete</button>
    <button (click)="cancel()">Cancel</button>
  </div>

  <!-- Results Area: Grid-based, drag-and-drop columns -->
  <div class="results-area">
    <div class="grid-table" cdkDropList cdkDropListOrientation="horizontal" [cdkDropListData]="columns"
      (cdkDropListDropped)="onDrop($event)" [style.gridTemplateColumns]="gridTemplateColumns">
      <div class="grid-column" *ngFor="let column of columns; let i = index" cdkDrag [cdkDragData]="column"
        (cdkDragEntered)="onDragEntered($event)" (cdkDragExited)="onDragExited($event)">
        <!-- Column Header -->
        <div class="grid-column-header">
          <span class="drag-handle" cdkDragHandle>â˜°</span>
          <ng-template cdkDragPreview>
            <div class="custom-drag-preview">{{ column.header }}</div>
          </ng-template>
          <ng-template cdkDragPlaceholder>
            <div class="custom-drag-placeholder">
              Dropping {{ column.header }} here
            </div>
          </ng-template>
          {{ column.header }}
        </div>

        <!-- Column cells -->
        <div class="grid-column-cell" *ngFor="let row of schedules; trackBy: trackByAdorationID"
          (click)="selectSchedule(row)">
          {{ getCellValue(row, column) }}
        </div>
      </div>
    </div>
  </div>
</div>