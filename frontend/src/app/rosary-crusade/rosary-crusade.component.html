<div class="rosary-crusade">
  <h2>Rosary Crusade</h2>

  <!-- Form Container -->
  <div class="form-container">
    <!-- Row 1: Confession and Mass Sections -->
    <div class="row-1">
      <div class="section confession" data-title="Confession">
        <div class="start-end-row">
          <div>
            <label>Start</label>
            <input type="time" [(ngModel)]="selectedCrusade.ConfessionStartTime" />
          </div>
          <div>
            <label>End</label>
            <input type="time" [(ngModel)]="selectedCrusade.ConfessionEndTime" />
          </div>
        </div>
      </div>
      <div class="section mass" data-title="Mass">
        <div class="start-end-row">
          <div>
            <label>Start</label>
            <input type="time" [(ngModel)]="selectedCrusade.MassStartTime" />
          </div>
          <div>
            <label>End</label>
            <input type="time" [(ngModel)]="selectedCrusade.MassEndTime" />
          </div>
        </div>
      </div>
    </div><!-- end row-1 -->

    <!-- Row 2: Rosary Crusade (40%) and Contact (60%) Sections -->
    <div class="row-2">
      <div class="section crusade" data-title="Rosary Crusade">
        <!-- Times -->
        <div class="start-end-row">
          <div>
            <label>Start</label>
            <input type="time" [(ngModel)]="selectedCrusade.CrusadeStartTime" />
            <div *ngIf="hasSubmitted && !selectedCrusade.CrusadeStartTime?.trim()" class="inline-error">
              Crusade Start is required.
            </div>
          </div>
          <div>
            <label>End</label>
            <input type="time" [(ngModel)]="selectedCrusade.CrusadeEndTime" />
            <div *ngIf="hasSubmitted && !selectedCrusade.CrusadeEndTime?.trim()" class="inline-error">
              Crusade End is required.
            </div>
          </div>
        </div>

        <!-- Diocese, Parish, State dropdowns -->
        <div class="location-row">
          <div>
            <label>Diocese</label>
            <select [(ngModel)]="selectedCrusade.DioceseID">
              <option [value]="0">-- select diocese --</option>
              <option *ngFor="let d of dioceseList" [value]="d.DioceseID">
                {{ d.DioceseName }}
              </option>
            </select>
            <div *ngIf="hasSubmitted && (!selectedCrusade.DioceseID || selectedCrusade.DioceseID === 0)"
              class="inline-error">
              Diocese is required.
            </div>
          </div>
          <div>
            <label>Parish</label>
            <select [(ngModel)]="selectedCrusade.ParishID">
              <option [value]="0">-- select parish --</option>
              <option *ngFor="let p of parishList" [value]="p.ParishID">
                {{ p.ParishName }}
              </option>
            </select>
            <div *ngIf="hasSubmitted && (!selectedCrusade.ParishID || selectedCrusade.ParishID === 0)"
              class="inline-error">
              Parish is required.
            </div>
          </div>
          <div>
            <label>State</label>
            <select [(ngModel)]="selectedCrusade.State">
              <option value="">-- select state --</option>
              <option *ngFor="let s of states" [value]="s">{{ s }}</option>
            </select>
            <div *ngIf="hasSubmitted && !selectedCrusade.State?.trim()" class="inline-error">
              State is required.
            </div>
          </div>
        </div>
      </div>

      <div class="section contact" data-title="Contact">
        <div class="contact-name">
          <label>Contact Name</label>
          <input type="text" [(ngModel)]="selectedCrusade.ContactName" />
        </div>

        <div class="contact-phone">
          <label>Contact Phone</label>
          <input type="text" [(ngModel)]="selectedCrusade.ContactPhone" />
        </div>

        <div class="contact-email">
          <label>Contact Email</label>
          <input type="text" [(ngModel)]="selectedCrusade.ContactEmail" />
        </div>
      </div>
    </div>

    <!-- Row 3: Comments Section (full width) -->
    <div class="row-3">
      <div class="section comments" data-title="Comments">
        <div class="comments-row">
          <textarea [(ngModel)]="selectedCrusade.Comments"></textarea>
        </div>
      </div>
    </div><!-- end row-3 -->
  </div><!-- end form-container -->

  <!-- Buttons -->
  <div class="buttons">
    <button (click)="addCrusade()">Add</button>
    <button (click)="modifyCrusade()">Modify</button>
    <button (click)="deleteCrusade()">Delete</button>
    <button (click)="cancel()">Cancel</button>
  </div>

  <!-- Results Area (Grid-Based, Drag-and-Drop Columns) -->
  <div class="results-area">
    <div class="grid-table" cdkDropList cdkDropListOrientation="horizontal" [cdkDropListData]="columns"
      (cdkDropListDropped)="onDrop($event)" [style.gridTemplateColumns]="gridTemplateColumns">
      <div class="grid-column" *ngFor="let column of columns; let i = index" cdkDrag [cdkDragData]="column"
        (cdkDragEntered)="onDragEntered($event)" (cdkDragExited)="onDragExited($event)">
        <div class="grid-column-header">
          <span class="drag-handle" cdkDragHandle>â˜°</span>
          <ng-template cdkDragPreview>
            <div class="custom-drag-preview">{{ column.header }}</div>
          </ng-template>
          <ng-template cdkDragPlaceholder>
            <div class="custom-drag-placeholder">Dropping {{ column.header }} here</div>
          </ng-template>
          {{ column.header }}
        </div>
        <div class="grid-column-cell" *ngFor="let row of crusades" (click)="selectCrusade(row)">
          {{ getCellValue(row, column) }}
        </div>
      </div>
    </div>
  </div>
</div>